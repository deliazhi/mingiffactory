{"dependencies":[{"name":"/Users/delia/Projects/mingiffactory/package.json","includedInParent":true,"mtime":1531014980238},{"name":"./main.css","dynamic":true,"parent":"/Users/delia/Projects/mingiffactory/index.html","resolved":"/Users/delia/Projects/mingiffactory/main.css"}],"generated":{"html":"<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <title>动图小工厂</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <script src=\"https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js\"></script>\n    <script src=\"https://cdn.bootcss.com/bootstrap/4.1.0/js/bootstrap.min.js\"></script>\n    <script src=\"https://cdn.bootcss.com/fabric.js/2.3.0/fabric.min.js\"></script>\n    <script src=\"https://cdn.bootcss.com/downloadjs/1.4.7/download.min.js\"></script>\n    <script src=\"https://cdn.bootcss.com/keypress/2.1.5/keypress.min.js\"></script>\n    <script src=\"https://cdn.bootcss.com/gif.js/0.2.0/gif.js\"></script>\n    <link rel=\"stylesheet\" type=\"text/css\" media=\"screen\" href=\"/133f4d31a10d14d0aea140c03d81a1ea.css\">\n    <link href=\"https://cdn.bootcss.com/bootstrap/4.1.0/css/bootstrap.min.css\" rel=\"stylesheet\">\n</head>\n<body>\n    <div class=\"container-fluid\">\n        <div class=\"row\">\n            <nav class=\"col-md-2 d-none d-md-block bg-light sidebar\">\n                <div class=\"sidebar-sticky\">\n                    \n                </div>\n            </nav>\n    \n            <main role=\"main\" class=\"col-md-9 ml-sm-auto col-lg-10 px-4\">\n                <div class=\"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom\">\n                    <h1 class=\"h2\">动图小工厂</h1>\n                </div>\n    \n                <canvas class=\"w-100\" id=\"myAvatar\" width=\"460\" height=\"460\"></canvas>\n                <div>\n                    <button class=\"btn btn-primary\" onclick=\"downloadit()\">下载图片</button>\n                    <button class=\"btn btn-outline-secondary\" onclick=\"debug()\">调试</button>\n                    <button class=\"btn btn-outline-secondary\" onclick=\"pic_add()\">加入动图序列</button>\n                    <button class=\"btn btn-outline-secondary\" onclick=\"pic_build()\">下载动图</button>\n                </div>\n                <div class=\"form-group editBar\">\n                    <input type=\"text\" class=\"form-control\" id=\"theText\" placeholder=\"点击画布中的文字进行修改\" disabled=\"disabled\" onchange=\"update_text()\">\n                </div>\n                <ul class=\"gif-images\">\n\n                </ul>\n            </main>\n        </div>\n    </div>\n    <script>\n        var canvas = new fabric.Canvas('myAvatar',{preserveObjectStacking:true});\n        canvas.backgroundColor='rgba(255,255,255,1)';\n        \n        fabric.Image.fromURL('avatar.png', function (oImg) {\n            //canvas.add(oImg);\n            canvas.insertAt(oImg,0);\n        });\n\n        fabric.Image.fromURL('github.png', function (oImg) {\n            canvas.insertAt(oImg,1);\n            oImg.set('top',48);\n            oImg.set('left', 69);\n            oImg.set('angle', 338);\n            oImg.set('scaleX', 0.45);\n            oImg.set('scaleY', 0.45);\n            oImg.set({cornerSize:15,padding:5,transparentCorners:true,cornerStyle:'circle',cornerColor:'red',borderColor:'red'});\n        });  \n        \n        var text=new fabric.Text('hello world',{top:100,left:100});\n        canvas.insertAt(text,2);\n        text.set('top',156);\n        text.set('left', 126);\n        text.set('angle', 341);\n        text.set('fill', 'white');\n        text.set({ cornerSize: 15, padding: 5, transparentCorners: true, cornerStyle: 'circle', cornerColor: 'red', borderColor:\n'red' });\n\n        $(function(){\n            var listener = new window.keypress.Listener();\n            \n            listener.simple_combo(\"shift s\", function () {\n                console.log(\"You pressed shift and s\");\n                var obj = canvas.getActiveObject();\n                if (obj) {\n                    canvas.remove(obj);\n                }\n            });\n\n            listener.simple_combo(\"]\", function () {\n                var obj = canvas.getActiveObject();\n                if (obj) { \n                    canvas.sendBackwards(obj); \n                } \n            });\n\n            listener.simple_combo(\"[\", function () {\n                var obj = canvas.getActiveObject();\n                if (obj) {\n                    canvas.bringForward(obj);\n                }\n            });\n\n            text_init();\n        });\n\n        function text_init(){\n            $(canvas.getObjects()).each((index,item)=>{\n                if(item.type=='text'){\n                    item.on(\"selected\", () => {\n                        $(\"#theText\").val(item.text);\n                        $(\"#theText\").prop(\"disabled\", false);\n                    });\n                }\n            });\n        }\n        \n        function update_text(){\n            var newText=$(\"#theText\").val();\n            if(newText.length>0){\n                var obj=canvas.getActiveObject();\n                if(obj&&obj.type=='text'){\n                    obj.set('text',newText);\n                    canvas.renderAll();\n                }\n            }\n        }\n\n        function downloadit(){\n            //console.log(canvas.toDataURL('png'));\n            download(canvas.toDataURL('png'),'avatar.png','image/png');\n        }\n\n        function debug(){\n            var obj = canvas.getActiveObject();\n            if(obj!=undefined){\n                console.log(\"top=\" + obj.top);\n                console.log(\"left=\" + obj.left);\n                console.log(\"angle=\" + obj.angle);\n                console.log(\"scaleX=\" + obj.scaleX);\n                console.log(\"scaleY=\" + obj.scaleY);\n            }\n        }\n\n        function pic_add(){\n            var data_url=canvas.toDataURL('png');\n            var li=$(\"<li><img src='\"+data_url+\"'/></li>\");\n            $(\".gif-images\").append(li);\n        }\n\n        function pic_build(){\n            var gif = new GIF({\n                workers: 2,\n                quality: 10,\n                width:460,\n                height:460\n            });\n            $(\".gif-images li img\").each((index,item)=>{\n                gif.addFrame(item,{delay:1000});\n            });\n            gif.on(\"finished\",function(blob){\n                download(blob,\"avatar.gif\",\"image/gif\");\n            });\n            gif.render();\n        }\n    </script>\n</body>\n</html>"},"hash":"e72943b0fe9fd8f636781db3ec2dfc30","cacheData":{},"id":1}